<style>
  .block-label {
    display: block;
  }

  .block-label+nb-radio-group>nb-radio {
    display: inline;
  }

  .border-red{
    border-color: #dc3545;
  }
  
  .text-red{
    color: #dc3545;
  }
</style>

<form [formGroup]="checkoutForm" (ngSubmit)="onSubmit()">
  <nb-card [nbSpinner]="loading" nbSpinnerStatus="success" nbSpinnerSize="giant">
    <nb-card-header>
      <div>
        <div>
          <img src="../../../assets/images/health-predictor-logo.png" alt="" style="width: 50px;">
          <h2 id="heartAttackPredictorTitle" style="color:#5781ff; display: inline-block; margin-left: 20px;">Heart Attack Predictor</h2>
        </div>
      </div>
    </nb-card-header>
    <nb-card-body>

      <div class="row">

        <div class="col-lg-3">
          <div class="form-group">
            <label for="age" class="label" id="ageLabel" >
              Age              
            </label>
            <input id="ageInput" type="number" nbInput fullWidth required placeholder="Eg: 32" formControlName="age" [ngClass]="{ 'border-red': submitted && f.age.errors }">

            <div *ngIf="submitted && f.age.invalid">
              <div *ngIf="f.age.errors.required" class="text-red">* Required</div>
            </div>
          </div>
        </div>

        <div class="col-lg-3">
          <div class="form-group">
            <label id="genderLabel" for="sex" class="label block-label">Gender</label>
<<<<<<< HEAD
            <nb-radio-group name="sex" id="genderRadio" [ngClass]="{ 'border-red': submitted && f.sex.errors }">
              <nb-radio id="maleRadio" [value]="male">Male</nb-radio>
              <nb-radio id="femaleRadio" [value]="female">Female</nb-radio>
=======
            <nb-radio-group formControlName="sex" name="sex" id="genderRadio" [ngClass]="{ 'border-red': submitted && f.sex.errors }">
              <nb-radio id="maleRadio" [value]="1">Male</nb-radio>
              <nb-radio id="femaleRadio" [value]="0">Female</nb-radio>
>>>>>>> f24507dc3ace458f64e00f4305d7759896cc20e6
            </nb-radio-group>
            <div *ngIf="submitted && f.sex.invalid">
              <div *ngIf="f.sex.errors.required" class="text-red">* Required</div>
            </div>      
<<<<<<< HEAD
            
=======
>>>>>>> f24507dc3ace458f64e00f4305d7759896cc20e6
          </div>
        </div>

        <div class="col-lg-3">
          <div class="form-group">
            <label id="chestPainLabel" for="f.cp.value" class="label block-label">Do you experience Chest Pain?</label>
            <nb-radio-group formControlName="cp" name="cp" id="chestPainRadio" [ngClass]="{ 'border-red': submitted && f.cp.errors }">
              <nb-radio id="chestPainYesRadio"  [value]="1">Yes</nb-radio>
              <nb-radio id="chestPainNoRadio"   [value]="0">No</nb-radio>
            </nb-radio-group>
            <div *ngIf="submitted && f.cp.invalid">
              <div *ngIf="f.cp.errors.required" class="text-red">* Required</div>
            </div>      
          </div>
        </div>

        <div class="col-lg-3">
          <div class="form-group">
            <label id="bloodPressureLabel" for="trestbps" class="label">
              Blood Pressure Level
              <span class="badge badge-pill badge-secondary" nbTooltip="Blood pressure is one of the vital signs, along with respiratory rate, heart rate, oxygen saturation, and body temperature. Can be measured in mmHg" nbTooltipStatus="primary" nbButton status="primary">i</span>
            </label>
            <input id="bloddPressureInput" type="text" nbInput required fullWidth placeholder="Eg: 120" class="is-invalid" formControlName="trestbps" [ngClass]="{ 'border-red': submitted && f.trestbps.errors }">
            <div *ngIf="submitted && f.trestbps.invalid">
              <div *ngIf="f.trestbps.errors.required" class="text-red">* Required</div>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-lg-3">
          <div class="form-group">
            <label id="cholesterolLabel" for="chol" class="label">
              Cholesterol Level
              <span class="badge badge-pill badge-secondary" nbTooltip="Cholesterol is a waxy substance found in blood. body needs cholesterol to build healthy cells, but high levels of cholesterol can increase risk of heart disease. With high cholesterol, can develop fatty deposits in blood vessels and it can be measured in mg/dL" nbTooltipStatus="primary" nbButton status="primary">i</span>
            </label>
            <input id="cholesterolInput" type="text" nbInput fullWidth placeholder="Eg: 150" formControlName="chol" [ngClass]="{ 'border-red': submitted && f.chol.errors }">
            <div *ngIf="submitted && f.chol.invalid">
                <div *ngIf="f.chol.errors.required" class="text-red">* Required</div>
              </div>
          </div>
        </div>

        <div class="col-lg-3">
          <div class="form-group">
            <label for="fbs" class="label" id="fastingBloodSugarLabel">
              Fasting Blood Sugar Level
              <span class="badge badge-pill badge-secondary" nbTooltip="A test to determine how much glucose (sugar) is in a blood sample after an overnight fast. For example, 100 mg/dl" nbTooltipStatus="primary" nbButton status="primary">i</span>
            </label>
            <input id="fastingBloodSugarInput" type="text" nbInput fullWidth placeholder="Eg: 120" formControlName="fbs" [ngClass]="{ 'border-red': submitted && f.fbs.errors }">
            <div *ngIf="submitted && f.fbs.invalid">
                <div *ngIf="f.fbs.errors.required" class="text-red">* Required</div>
              </div>
          </div>
        </div>

        <div class="col-lg-3">
          <div class="form-group">
            <label for="" class="label block-label" id="restECGLabel">
              Resting Electrocardiographic
              <span class="badge badge-pill badge-secondary" nbTooltip="The resting electrocardiogram is a test that measures the electrical activity of the heart." nbTooltipStatus="primary" nbButton status="primary">i</span>
            </label>
            <nb-radio-group formControlName="restecg" name="restecg" id="restECGRadio" [ngClass]="{ 'border-red': submitted && f.restecg.errors }">
              <nb-radio id="restECGPositiveRadio" [value]="1">Positive</nb-radio>
              <nb-radio id="restECGNegativeRadio" [checked]="true" [value]="0">Negative</nb-radio>
            </nb-radio-group>
            <div *ngIf="submitted && f.restecg.invalid">
                <div *ngIf="f.restecg.errors.required" class="text-red">* Required</div>
              </div>
          </div>
        </div>
        

        <div class="col-lg-3">
          <div class="form-group">
            <label for="" class="label" id="heartRateLabel">
              Maximum Heart Rate Achieved
              <span class="badge badge-pill badge-secondary" nbTooltip="MHR refers to the fastest rate at which your heart will beat in one minute. Formula, 206.9 - (0.67 x age)" nbTooltipStatus="primary" nbButton status="primary">i</span>
            </label>
            <input id="heartRateInput" type="text" nbInput fullWidth placeholder="Eg: 150" formControlName="thalach" [ngClass]="{ 'border-red': submitted && f.thalach.errors }">
            <div *ngIf="submitted && f.thalach.invalid">
                <div *ngIf="f.thalach.errors.required" class="text-red">* Required</div>
              </div>
          </div>
        </div>
      </div>

      <div class="row">

        <div class="col-lg-3">
          <div class="form-group">
            <label id="anginaLabel" for="exang" class="label block-label">
              Exercise includes Angina
              <span class="badge badge-pill badge-secondary" nbTooltip="Upper-body exercises may precipitate angina more readily than lower-body exercises because of a higher press or response." nbTooltipStatus="primary" nbButton status="primary">i</span>
            </label>
            <nb-radio-group formControlName="exang" name="exang" id="anginaRadio" [ngClass]="{ 'border-red': submitted && f.exang.errors }">
              <nb-radio id="anginaYesRadio" [value]="1">Yes</nb-radio>
              <nb-radio id="anginaNoRadio" [checked]="true" [value]="0">No</nb-radio>
            </nb-radio-group>
            <div *ngIf="submitted && f.exang.invalid">
                <div *ngIf="f.exang.errors.required" class="text-red">* Required</div>
              </div>
          </div>
        </div>

        <div class="col-lg-3">
          <div class="form-group">
            <label id="depressionLabel" for="oldpeak" class="label">
              Depression induced by exercise
              <span class="badge badge-pill badge-secondary" nbTooltip="Depression manifests physically by causing disturbed sleep, reduced energy, appetite changes, body aches, and increased pain perception, all of which can result in less motivation to exercise." nbTooltipStatus="primary" nbButton status="primary">i</span>
            </label>
            <input id="depressionInput" type="text" nbInput fullWidth placeholder="0 - 10" formControlName="oldpeak" [ngClass]="{ 'border-red': submitted && f.oldpeak.errors }">
            <div *ngIf="submitted && f.oldpeak.invalid">
                <div *ngIf="f.oldpeak.errors.required" class="text-red">* Required</div>
                <div *ngIf="f.oldpeak.errors.pattern" class="text-red">* Input should be between 0 to 10</div>
            </div>
          </div>
        </div>

        <div class="col-lg-3">
          <div class="form-group">
            <label id="peakExerciseLabel" for="slope" class="label">
              Slope of the peak exercise
              <span class="badge badge-pill badge-secondary" nbTooltip="Slope of the peak exercise" nbTooltipStatus="primary" nbButton status="primary">i</span>
            </label>
            <input id="peakExerciseInput" type="text" nbInput fullWidth placeholder="0 - 1" formControlName="slope" [ngClass]="{ 'border-red': submitted && f.slope.errors }">
            <div *ngIf="submitted && f.slope.invalid">
                <div *ngIf="f.slope.errors.required" class="text-red">* Required</div>
                <div *ngIf="f.slope.errors.pattern" class="text-red">* Input should be either 0 or 1</div>
              </div>
          </div>
        </div>

        <div class="col-lg-3">
          <div class="form-group">
            <label id="fluoroscopyLabel" for="ca" class="label">
              Vessels colored by Flouoroscopy
              <span class="badge badge-pill badge-secondary" nbTooltip="Angiography or arteriography is a medical imaging technique used to visualize the inside, or lumen, of blood vessels and organs of the body, with particular interest in the arteries, veins, and the heart chambers. This is traditionally done by injecting a radio-opaque contrast agent into the blood vessel and imaging using X-ray based techniques such as fluoroscopy." nbTooltipStatus="primary" nbButton status="primary">i</span>
            </label>
            <input id="fluoroscopyInput" type="text" nbInput fullWidth placeholder="0 - 10" formControlName="ca" [ngClass]="{ 'border-red': submitted && f.ca.errors }">
            <div *ngIf="submitted && f.ca.invalid">
                <div *ngIf="f.ca.errors.required" class="text-red">* Required</div>
                <div *ngIf="f.ca.errors.pattern" class="text-red">* Input should be between 0 to 10</div>
              </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-lg-3">
          <div class="form-group">
            <label id="thalassemiaLabel" for="thal" class="label">
              Thalassemia Level
              <span class="badge badge-pill badge-secondary" nbTooltip="Thalassemia is an inherited blood disorder in which the body makes an abnormal form of hemoglobin results in excessive destruction of red blood cells" nbTooltipStatus="primary" nbButton status="primary">i</span>
            </label>
            <input id="thalassemiaInput" type="text" nbInput fullWidth placeholder="3=normal 6=fixed defect 7=reversible defect"
              formControlName="thal" [ngClass]="{ 'border-red': submitted && f.thal.errors }">
              <div *ngIf="submitted && f.thal.invalid">
                  <div *ngIf="f.thal.errors.required" class="text-red">* Required</div>
                  <div *ngIf="f.thal.errors.pattern" class="text-red">* Input should be 3 or 6 or 7</div>
                </div>
          </div>
        </div>
      </div>

    </nb-card-body>
    <nb-card-footer style="text-align: center;">
      <button nbButton size="medium" shape="semi-round" id="heartPredictorCalculateBtn">Calculate</button>
    </nb-card-footer>
  </nb-card>
</form>


<!-- Dialogue ref -->
<style>
  .result-image {
    display: block;
    margin: 0 auto;
    margin-bottom: 30px;
  }

  .result-message-text {
    color: #00D68D;
    text-align: center;
    font-weight: bold;
    padding: 30px 0px;
  }

  .danger-tips-title{
    text-align: center;
  }
  .result-message-text .danger-message{
    font-weight: bold;
    color: black;
    padding: 20px 0px;
    
  }

  .danger-tips-msg{
    border-left: 0.5px solid rgba(0,0,0,0.5);
    font-size: 12px;
    padding: 5px;
  }

  .danger-type-msg{
    text-align: center;
    
  }

  .predictor-result {
    margin-bottom: 40px;
  }

  .health-predictor-result-container {
    width: 70vh;
  }

  .nb-dialog-container{
    overflow: scroll;
  }
</style>



<ng-template #dialog let-data let-ref="dialogRef">
  <nb-card>
    <nb-card-header>Heart Attack Predictor</nb-card-header>
    <nb-card-body>
      <div class="health-predictor-result-container">
        <div class="predictor-result-success" *ngIf="isHeartOK; else dangerTemplate">
          <div class="result-title"></div>
          <div class="result-body">
            <div class="predictor-result">
              <div class="result-message">
                <img src="../../../assets/images/heart-ok.png" alt="" class="result-image">
                <div class="result-message-text">
                  Congratulations! You are safe.
                </div>
              </div>
            </div>

            <div>
              <div class="card-row row">

                <div class="card-col col-lg-6">
                  <nb-card accent="info">
                    <nb-card-header >
                      <div style="text-align: center;">
                        Cholesterol
                      </div>
                    </nb-card-header>
                    <nb-card-body>
                      <div style="text-align: center;">
                        174
                      </div>
                    </nb-card-body>
                  </nb-card>
                </div>
                <div class="col-lg-6">
                  <nb-card accent="info">
                    <nb-card-header>
                      <div style="text-align: center;">
                        Blood Sugar
                      </div>
                    </nb-card-header>
                    <nb-card-body>
                      <div style="text-align: center;">
                        120
                      </div>
                    </nb-card-body>
                  </nb-card>
                </div>
              </div>
            </div>
          </div>
        </div>

        <ng-template #dangerTemplate>
        <div class="predictor-result-danger">
          <div class="result-title"></div>
          <div class="result-body">
            <div class="predictor-result">
              <div class="result-message">               
                <div class="result-message-text">
                  <div class="danger-message">
                    <span> We suggest you to have a consultation with a cardiologist at the earliest.</span>
                  </div>
                  <div class="appointment-btn">

                    <!-- TODO: Add a button below to Book and Appointment with Doctor -->
                    <button nbButton size="medium" shape="semi-round">Book Appointment Now</button>
                  </div>
                </div>
              </div>
            </div>

            <div>
              <div class="card-row row">

                <div class="card-col col-lg-12">
                  <nb-card accent="info">                    
                    <nb-card-body>
                      <div class="row">
                        <div class="col col-lg-3"> 
                          <div class="danger-type-msg">
                            Cholesterol
                          </div>
                        </div>
                        <div class="col col-lg-9">
                          <div class="danger-tips-title">
                            Tips
                          </div>
                          <div class="danger-tips-msg">
                            High Blood Cholesterol can be caused due to factors like smoking, an unhealthy diet and lack of exercise,
                            as well as having an underlying condition, such as high blood pressure or diabetes.
                          </div>
                        </div>
                      </div>
                    </nb-card-body>
                  </nb-card>
                </div>

                <div class="col-lg-12">
                  <nb-card accent="info">
                    <nb-card-body>

                      <div class="row">
                        <div class="col col-lg-3"> 
                          <div class="danger-tips-title">
                            Blood Sugar
                          </div>
                        </div>
                        <div class="col col-lg-9">
                          <div class="danger-tips-title">
                            Tips
                          </div>
                          <div class="danger-tips-msg">
                            Carbohydrates: Eating food containing too much carbohydrates, a form of sugar.                            
                            Blood sugar levels in patients with diabetes can rise within hours after eating.
                          </div>
                        </div>
                      </div>

                    </nb-card-body>
                  </nb-card>
                </div>
              </div>
            </div>
          </div>
        </div>
      </ng-template>
      </div>
    </nb-card-body>
    <nb-card-footer style="text-align: center;">
      <button nbButton (click)="ref.close()">Close</button>
    </nb-card-footer>
  </nb-card>
</ng-template>